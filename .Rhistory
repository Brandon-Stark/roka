setwd("/Users/alliblk/Desktop/Git_Repo_Folders/roka/beast")
rokaHIV = read.table("roka_env_aligned_strict_bs10_skyline.tsv", header=T)
#set up plotting panels
rokaHIV = read.table("roka_env_aligned_strict_bs10_skyline.tsv", header=T)
par(mfrow=c(1,1))
plot(rokaHIV$Median ~rokaHIV$Time, type="l",
log="y", ylim=c(0.01,1000), #note log 0 is -inf, so need a value
col="light blue",
ylab = expression(paste(italic("N"[e]),tau," ","(years)")),
xlab= "Sampling Year",
main = "UP",
lwd=6)
col="black",
log="y", #note log 0 is -inf, so need a value
plot(rokaHIV$Median ~rokaHIV$Time, type="l",
log="y", #note log 0 is -inf, so need a value
col="black",
ylab = expression(paste(italic("N"[e]),tau," ","(years)")),
xlab= "Sampling Year",
main = "UP",
lwd=6)
ylab = expression(paste(italic("N"[e]),tau),
plot(rokaHIV$Median ~rokaHIV$Time, type="l",
log="y", #note log 0 is -inf, so need a value
col="black",
ylab = expression(paste(italic("N"[e]),tau),
xlab= "Time (Days)",
main = "UP",
lwd=6)
#the line above w
plot(rokaHIV$Median ~rokaHIV$Time, type="l",
log="y", #note log 0 is -inf, so need a value
col="black",
ylab = expression(paste(italic("N"[e]),tau)),
xlab= "Time (Days)",
main = "UP",
lwd=6)
plot(rokaHIV$Median ~rokaHIV$Time, type="l",
log="y", #note log 0 is -inf, so need a value
col="black",
ylab = expression(paste(italic("N"[e]),tau)),
xlab= "Time (Days)",
main = "UP",
lwd=6)
#make the polygon border vectors
roka_X = c(rokaHIV$Time, rev(rokaHIV$Time))
roka_Y = c(rokaHIV$Lower,rev(rokaHIV$Upper))
#plot the polygon
polygon(roka_X, roka_Y, border=NA, col="light blue")
#plot the skyline lines over top of the polygon
lines(roka_HIV$Median ~roka_HIV$Time, type="l",
lwd=4, col="black")
lines(roka_HIV$Median ~roka_HIV$Time, type="l",
lwd=4, col="black")
#make the polygon border vectors
roka_X = c(rokaHIV$Time, rev(rokaHIV$Time))
roka_Y = c(rokaHIV$Lower,rev(rokaHIV$Upper))
#plot the polygon
polygon(roka_X, roka_Y, border=NA, col="light blue")
#plot the skyline lines over top of the polygon
lines(rokaHIV$Median ~rokaHIV$Time, type="l",
lwd=4, col="black")
plot(rokaHIV$Median ~rokaHIV$Time, type="l",
log="y", #note log 0 is -inf, so need a value
col="black",
ylab = expression(paste(italic("N"[e]),tau)),
xlab= "Time (Days)",
main = "Roka HIV Outbreak",
lwd=6)
polygon(roka_X, roka_Y, border=NA, col="light grey")
lines(rokaHIV$Median ~rokaHIV$Time, type="l",
lwd=4, col="black")
#plot the polygon
polygon(roka_X, roka_Y, border=NA, col="light blue")
#plot the skyline lines over top of the polygon
lines(rokaHIV$Median ~rokaHIV$Time, type="l",
lwd=4, col="black")
getwd()
setwd("/Users/alliblk/Desktop/Figure Data Files/Skyline Plots")
#Remember to remove title line from tsv file manually before
#loading the data into R.
UCskyline = read.table("UC_BS10_skylineplotdata.tsv", header=T)
UPskyline = read.table("UP_BS10_skylineplotdata.tsv",header=T)
#set up plotting panels
par(mfrow=c(1,2))
#UP SKYLINE PLOT
plot(UPskyline$Median ~UPskyline$Time, type="l",
log="y", ylim=c(0.01,1000), #note log 0 is -inf, so need a value
col="light blue",
ylab = expression(paste(italic("N"[e]),tau," ","(years)")),
xlab= "Sampling Year",
main = "UP",
lwd=6)
#the line above will be covered by the polygon
#however this allows me to get the plot area, axes, labels
#etc that I want to have on the plot.
#make the polygon border vectors
UP_X = c(UPskyline$Time, rev(UPskyline$Time))
UP_Y = c(UPskyline$Lower,rev(UPskyline$Upper))
#plot the polygon
polygon(UP_X, UP_Y, border=NA, col="light blue")
#plot the skyline lines over top of the polygon
lines(UPskyline$Median ~UPskyline$Time, type="l",
lwd=4, col="black")
#NOTE! PLOT THE BELOW LINES TO MAKE SURE THAT THE POLYGON IS
#CORRECT, but then comment out for no borders.
#lines(UPskyline$Upper~UPskyline$Time, type ="l",
#lwd=2, lty=2, col= "black")
#lines(UPskyline$Lower~UPskyline$Time, type ="l",
#lwd=2, lty=2, col="black")
#UC Skyline Plot
plot(UCskyline$Median ~UCskyline$Time, type="l",
log="y", ylim=c(0.01,1000),
col="orange",
ylab = expression(paste(italic("N"[e]),tau," ","(years)")),
xlab= "Sampling Year",
main= "UC",
lwd=4)
UC_X = c(UCskyline$Time, rev(UCskyline$Time))
UC_Y = c(UCskyline$Lower,rev(UCskyline$Upper))
#plot the polygon
polygon(UC_X, UC_Y, border=NA, col="orange")
#plot the skyline lines over top of the polygon
lines(UCskyline$Median ~UCskyline$Time, type="l",
lwd=4, col="black")
#lines(UCskyline$Upper~UCskyline$Time, type ="l",
#lwd=2, lty=2, col= "black")
#lines(UCskyline$Lower~UCskyline$Time, type ="l",
#lwd=2, lty=2, col="black")
setwd("/Users/alliblk/Desktop/Figure Data Files/Skyline Plots")
getwd()
setwd("/Users/alliblk/Desktop/Figure Data Files/Skyline Plots")
setwd("/Users/alliblk/Desktop/Figure Data Files/Skyline Plots")
#UP SKYLINE PLOT
plot(rokaHIV$Median ~rokaHIV$Time, type="l",
log="y", #note log 0 is -inf, so need a value
col="black",
xlim = c(600,0),
ylab = expression(paste(italic("N"[e]),tau)),
xlab= "Time (Days)",
main = "Roka HIV Outbreak",
lwd=6)
par(mfrow=c(1,1))
#UP SKYLINE PLOT
plot(rokaHIV$Median ~rokaHIV$Time, type="l",
log="y", #note log 0 is -inf, so need a value
col="black",
xlim = c(600,0),
ylab = expression(paste(italic("N"[e]),tau)),
xlab= "Time (Days)",
main = "Roka HIV Outbreak",
lwd=6)
#make the polygon border vectors
roka_X = c(rokaHIV$Time, rev(rokaHIV$Time))
roka_Y = c(rokaHIV$Lower,rev(rokaHIV$Upper))
#plot the polygon
polygon(roka_X, roka_Y, border=NA, col="light blue")
#plot the skyline lines over top of the polygon
lines(rokaHIV$Median ~rokaHIV$Time, type="l",
lwd=4, col="black")
#UP SKYLINE PLOT
plot(rokaHIV$Median ~rokaHIV$Time, type="l",
log="y", #note log 0 is -inf, so need a value
col="black",
xlim = c(600,5),
ylab = expression(paste(italic("N"[e]),tau)),
xlab= "Time (Days)",
main = "Roka HIV Outbreak",
lwd=6)
#the line above will be covered by the polygon
#however this allows me to get the plot area, axes, labels
#etc that I want to have on the plot.
#make the polygon border vectors
roka_X = c(rokaHIV$Time, rev(rokaHIV$Time))
roka_Y = c(rokaHIV$Lower,rev(rokaHIV$Upper))
#plot the polygon
polygon(roka_X, roka_Y, border=NA, col="light blue")
#plot the skyline lines over top of the polygon
lines(rokaHIV$Median ~rokaHIV$Time, type="l",
lwd=4, col="black")
#NOTE! PLOT THE BELOW LINES TO MAKE SURE THAT THE POLYGON IS
#CORRECT, but then comment out for no borders.
#lines(UPskyline$Upper~UPskyline$Time, type ="l",
#lwd=2, lty=2, col= "black")
#lines(UPskyline$Lower~UPskyline$Time, type ="l",
#lwd=2, lty=2, col="black")
#UC Skyline Plot
plot(UCskyline$Median ~UCskyline$Time, type="l",
log="y", ylim=c(0.01,1000),
col="orange",
ylab = expression(paste(italic("N"[e]),tau," ","(years)")),
xlab= "Sampling Year",
main= "UC",
lwd=4)
UC_X = c(UCskyline$Time, rev(UCskyline$Time))
UC_Y = c(UCskyline$Lower,rev(UCskyline$Upper))
#plot the polygon
polygon(UC_X, UC_Y, border=NA, col="orange")
#plot the skyline lines over top of the polygon
lines(UCskyline$Median ~UCskyline$Time, type="l",
lwd=4, col="black")
#lines(UCskyline$Upper~UCskyline$Time, type ="l",
#lwd=2, lty=2, col= "black")
#lines(UCskyline$Lower~UCskyline$Time, type ="l",
#lwd=2, lty=2, col="black")
plot(rokaHIV$Median ~rokaHIV$Time, type="l",
log="y", #note log 0 is -inf, so need a value
col="black",
xlim = c(600,20),
ylab = expression(paste(italic("N"[e]),tau)),
xlab= "Time (Days)",
main = "Roka HIV Outbreak",
lwd=6)
#the
UC_X = c(UCskyline$Time, rev(UCskyline$Time))
UC_Y = c(UCskyline$Lower,rev(UCskyline$Upper))
#plot the polygon
polygon(UC_X, UC_Y, border=NA, col="orange")
#plot the skyline lines over top of the polygon
lines(UCskyline$Median ~UCskyline$Time, type="l",
lwd=4, col="black")
#lines(UCskyline$Upper~UCskyline$Time,
#make the polygon border vectors
roka_X = c(rokaHIV$Time, rev(rokaHIV$Time))
roka_Y = c(rokaHIV$Lower,rev(rokaHIV$Upper))
#plot the polygon
polygon(roka_X, roka_Y, border=NA, col="light blue")
#plot the skyline lines over top of the polygon
lines(rokaHIV$Median ~rokaHIV$Time, type="l",
lwd=4, col="black")
#UP SKYLINE PLOT
plot(rokaHIV$Median ~rokaHIV$Time, type="l",
log="y", #note log 0 is -inf, so need a value
col="black",
xlim = c(600,20),
ylab = expression(paste(italic("N"[e]),tau)),
xlab= "Time (Days)",
main = "Roka HIV Outbreak",
lwd=6)
#the line above will be covered by the polygon
#however this allows me to get the plot area, axes, labels
#etc that I want to have on the plot.
#make the polygon border vectors
roka_X = c(rokaHIV$Time, rev(rokaHIV$Time))
roka_Y = c(rokaHIV$Lower,rev(rokaHIV$Upper))
#plot the polygon
polygon(roka_X, roka_Y, border=NA, col="light blue")
#plot the skyline lines over top of the polygon
lines(rokaHIV$Median ~rokaHIV$Time, type="l",
lwd=4, col="black")
#UP SKYLINE PLOT
plot(rokaHIV$Median ~rokaHIV$Time, type="l",
log="y", #note log 0 is -inf, so need a value
col="black",
xlim = c(600,25),
ylab = expression(paste(italic("N"[e]),tau)),
xlab= "Time (Days)",
main = "Roka HIV Outbreak",
lwd=6)
#the line above will be covered by the polygon
#however this allows me to get the plot area, axes, labels
#etc that I want to have on the plot.
#make the polygon border vectors
roka_X = c(rokaHIV$Time, rev(rokaHIV$Time))
roka_Y = c(rokaHIV$Lower,rev(rokaHIV$Upper))
#plot the polygon
polygon(roka_X, roka_Y, border=NA, col="light blue")
#plot the skyline lines over top of the polygon
lines(rokaHIV$Median ~rokaHIV$Time, type="l",
lwd=4, col="black")
#UP SKYLINE PLOT
plot(rokaHIV$Median ~rokaHIV$Time, type="l",
log="y", #note log 0 is -inf, so need a value
col="black",
xlim = c(600,22),
ylab = expression(paste(italic("N"[e]),tau)),
xlab= "Time (Days)",
main = "Roka HIV Outbreak",
lwd=6)
#the line above will be covered by the polygon
#however this allows me to get the plot area, axes, labels
#etc that I want to have on the plot.
#make the polygon border vectors
roka_X = c(rokaHIV$Time, rev(rokaHIV$Time))
roka_Y = c(rokaHIV$Lower,rev(rokaHIV$Upper))
#plot the polygon
polygon(roka_X, roka_Y, border=NA, col="light blue")
#plot the skyline lines over top of the polygon
lines(rokaHIV$Median ~rokaHIV$Time, type="l",
lwd=4, col="black")
plot(rokaHIV$Median ~rokaHIV$Time, type="l",
log="y", #note log 0 is -inf, so need a value
col="black",
xlim = c(600,22),
ylim = c(0,100000)
ylab = expression(paste(italic("N"[e]),tau)),
xlab= "Time (Days)",
main = "Roka HIV Outbreak",
lwd=6)
#the line above wil
plot(rokaHIV$Median ~rokaHIV$Time, type="l",
log="y", #note log 0 is -inf, so need a value
col="black",
xlim = c(600,22),
ylim = c(0,100000)
ylab = expression(paste(italic("N"[e]),tau)),
xlab= "Time (Days)",
main = "Roka HIV Outbreak",
lwd=6)
plot(rokaHIV$Median ~rokaHIV$Time, type="l",
log="y", #note log 0 is -inf, so need a value
col="black",
xlim = c(600,22),
ylim = c(1,100000)
ylab = expression(paste(italic("N"[e]),tau)),
xlab= "Time (Days)",
main = "Roka HIV Outbreak",
lwd=6)
plot(rokaHIV$Median ~rokaHIV$Time, type="l",
log="y", #note log 0 is -inf, so need a value
col="black",
xlim = c(600,22),
ylim = c(1,100000),
ylab = expression(paste(italic("N"[e]),tau)),
xlab= "Time (Days)",
main = "Roka HIV Outbreak",
lwd=6)
plot(rokaHIV$Median ~rokaHIV$Time, type="l",
log="y", #note log 0 is -inf, so need a value
col="black",
xlim = c(600,22),
ylim = c(100,100000),
ylab = expression(paste(italic("N"[e]),tau)),
xlab= "Time (Days)",
main = "Roka HIV Outbreak",
lwd=6)
polygon(roka_X, roka_Y, border=NA, col="light blue")
lines(rokaHIV$Median ~rokaHIV$Time, type="l",
lwd=4, col="black")
plot(rokaHIV$Median ~rokaHIV$Time, type="l",
log="y", #note log 0 is -inf, so need a value
col="black",
xlim = c(600,22),
ylim = c(100,200000),
ylab = expression(paste(italic("N"[e]),tau)),
xlab= "Time (Days)",
main = "Roka HIV Outbreak",
lwd=6)
polygon(roka_X, roka_Y, border=NA, col="light blue")
plot(rokaHIV$Median ~rokaHIV$Time, type="l",
log="y", #note log 0 is -inf, so need a value
col="black",
xlim = c(600,22),
ylim = c(100,500000),
ylab = expression(paste(italic("N"[e]),tau)),
xlab= "Time (Days)",
main = "Roka HIV Outbreak",
lwd=6)
#the line
polygon(roka_X, roka_Y, border=NA, col="light blue")
lines(rokaHIV$Median ~rokaHIV$Time, type="l",
lwd=4, col="black")
plot(rokaHIV$Median ~rokaHIV$Time, type="l",
log="y", #note log 0 is -inf, so need a value
col="black",
xlim = c(600,22),
ylim = c(100,500000),
ylab = expression(paste(italic("N"[e]),tau)),
xlab= "Time (Days)",
main = "Roka HIV Outbreak",
lwd=6)
par(mfrow=c(1,1))
plot(rokaHIV$Median ~rokaHIV$Time, type="l",
log="y", #note log 0 is -inf, so need a value
col="black",
xlim = c(600,22),
ylim = c(100,1000000),
ylab = expression(paste(italic("N"[e]),tau)),
xlab= "Time (Days)",
main = "Roka HIV Outbreak",
lwd=6)
#plot the polygon
polygon(roka_X, roka_Y, border=NA, col="light blue")
#plot the skyline lines over top of the polygon
lines(rokaHIV$Median ~rokaHIV$Time, type="l",
lwd=4, col="black")
getwd()
setwd("/Users/alliblk/Desktop/Git_Repo_Folders/roka/")
getwd()
rokaFrancois = read.tsv("Francois_strictLog.tsv", header=T)
rokaFrancois = read.table("Francois_strictLog.tsv", header=T)
head(rokaFrancois)
head(rokaFrancois)
head(rokaFrancois$clock.rate)
clockRateYears = (rokaFrancois$clock.rate * 365)
head(clockRateYears. n=25)
head(clockRateYears, n=25)
plot(clockRateYears)
plot(clockRateYears)
plot(rokaFrancois$clock.rate)
plot(rokaFrancois$clock.rate, ylim =c(0,100))
plot(rokaFrancois$clock.rate, ylim =c(0,10))
plot(rokaFrancois$clock.rate, ylim =c(0,1))
plot(rokaFrancois$clock.rate, ylim =c(0,0/0005))
plot(rokaFrancois$clock.rate, ylim =c(0,0.0005))
summary(clockRateYears)
sd(clockRateYears)
summary(rokaFrancois$clock.rate)
sd(rokaFrancois$clock.rate)
hist(rokaFrancois$clock.rate, ylim =c(0,0.0005))
hist(clockRateYears)
hist(rokaFrancois$clock.rate)
hist(rokaFrancois$clock.rate, xlim=c(0,1e-3))
hist(rokaFrancois$clock.rate, xlim=c(0,1))
hist(rokaFrancois$clock.rate, xlim=c(0,0.2))
hist(rokaFrancois$clock.rate, xlim=c(0,0.005))
hist(rokaFrancois$clock.rate, xlim=c(0,0.05))
hist(rokaFrancois$clock.rate, xlim=c(0,0.08))
hist(rokaFrancois$clock.rate, xlim=c(0,0.08), bin =20)
hist(rokaFrancois$clock.rate, xlim=c(0,0.08), breaks=20)
summary(rokaFrancois$clock.rate)
sd(rokaFrancois$clock.rate)
burnedLogFrancois = rokaFrancois[c(10000000:)]
burnedLogFrancois = rokaFrancois[c(10000000:100000000)]
length(burnedLogFrancois)
burnedLogFrancois = rokaFrancois[c(10000000:100000000)]
head(burnedLogFrancois)
View(rokaFrancois)
length(rokaFrancois)
length(rokaFrancois$clock.rate)
100000000/100000
100000*0.1
burnedLogFrancois = rokaFrancois[c(10000:)]
burnedLogFrancois = rokaFrancois[c(10000:100000)]
head(burnedLogFrancois)
burnedclockrate_days= rokaFrancois$clock.rate[c(10000:100000)]
head(burnedclockrate_days)
hist(burnedclockrate_days)
hist(burnedclockrate_days, breaks=20)
hist(burnedclockrate_days, breaks=50)
hist(burnedclockrate_days, breaks=50, col="red")
burnedclockRate_years = (burnedclockrate_days * 365)
head(clockRateYears, n=25)
hist(burnedclockRate_years, breaks = 50, col = "blue")
summary(burnedclockRate_years)
sd(burnedclockRate_years)
#check that summary stats for clock.rate (days) gives same estimates as Tracer
summary(burnedclockrate_days)
sd(burnedclockrate_days)
summary(burnedclockRate_years)
sd(burnedclockRate_years)
#Get the mean and the standard deviation for the clock rate (in years)
summary(burnedclockRate_years)
sd(burnedclockRate_years)
200000000/100000
install.packages("lubridate")
library lubridate
library lubridate
head(rokaHIV)
