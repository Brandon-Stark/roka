# BEAST coalescent analysis

Repo for coalescent trees and skyline plots generated by BEAST 1.8.2.

## Env-only analysis notes:

* Roka viruses `NCHADS116`, `NCHADS171`, `NCHADS184` and `NCHADS185` cluster within control sequences and are not included.

* The clock prior used is based on the posterior distribution of clock.rate from the log files originally sent from Francois and colleagues [here](https://github.com/blab/roka/tree/master/FrancoisData). In these files, the rates were in DAYS. Log files were exported to R where the rates were converted to years (multiplied by 365) using [this R script](https://github.com/blab/roka/blob/master/Scripts/R_scripts/clockprior_daytoyear.R). Mean and standard deviation were calculated on the yearly rate data and parameterize the prior distribution on the clock rate (N ~(0.004912, 0.0006632)).

* MCC tree is based on 2000 samples from the posterior with 400 tree burn-in.

* Sampling time 0.0 is January 28, 2015

* For skyline plot, the plotted values are the median population sizes. The plot runs from time 0 to the mean estimate of TMRCA.

* Mean TMRCA is 3.235 years, which puts common ancestor at 2011-11-04 (95% CI between 2009-12-31 and 2013-04-25).

* For the logistic growth model we changed the default priors on logistic.t50 and the logistic.growthRate. We don't know where on the logistic growth curve we are (population may still be growing exponentially and t50 hasn't been reached yet, or t50 may have already occurred). To accommodate this the lower on the t50 prior was changed to -10 (allowing t50 to occur up to 10 years in the future). Note that positive values of t50 would represent n years back in time (the present is 0). For logistic.growthRate the prior is a normal distribution (N~(0,10)) with initial value 0.

    `<uniformPrior lower="-10" upper="10">`
    `   <parameter idref="logistic.t50"/>`
    `</uniformPrior>`

* BEAST will not run a logistic growth model in which t50 is negative. UPDATE: This is unfortunate because analysis of the logistic run shows that the highest density of the t50 estimate is pushed to 0 (you can see this by looking at the t50 estimates from the log file in Tracer). This indicates that the t50 probably really is in the future. Since logistic growth can't accomodate this we'll need to switch to an exponential demographic model.

#### Figures

Maximum Clade Credibility (MCC) tree

![](env_only/figures/roka_env_strictYEARS_bs10.mcc.png)

Skyline plot to look at changes in viral population size over time.

![](env_only/figures/roka_skyline_YEARS.png)


## Env + prot + RT analysis:

#### Root-to-tip divergence for different gene's (as estimated in Path-O-Gen)

Slope of the regression line estimates the rate of a strict clock and correlation coefficient presents an estimate of the variation in the data accounted for by the regression. All estimates use best fitting root.

* Env: Slope(rate) = 2.8954E-3, Correlation Coefficient = 0.5037

* Prot: Slope(rate)	= 9.711E-4, Correlation Coefficient	= 0.4673

* RT: Slope(rate) = 9.0201E-4, Correlation Coefficient = 0.5559


#### Molecular clock estimation from control sequences

BEAST analyses to estimate the posterior distribution of the evolutionary rate were conducted using the following models and priors:

* HKY with Gamma (4) rate variation between sites as the evolutionary model

* Bayesian Skyline with 10 intervals as the demographic model

* Strict molecular clock with prior distribution of XXX (need to figure this out)
